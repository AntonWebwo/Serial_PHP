# Serial_PHP
Serial Port CLI for PHP
Данная консольная програма предназначена в первую очередь для взаимодействия скриптов PHP с последовательными портами.
Программа написана под операционные системы Windows X64 и X86.
Так же программу можно использовать и для других языков программирования, в том числе и для CMD.EXE.
Програма может: указать текущий COM-порт, подключеный к компьютеру и взаимодействовать с устройтвом через приём/передачу информации по COM-порту. Каждый раз програма открывает порт для отработки задачи, за тем закрывает порт, что не блокирует его для других програм.

Пример интеграции в PHP работу програмы:

<?php
$get_serial = shell_exec('serial -G');//Отправляем запрос текущего порта
echo "Текущий порт: ".$get_serial;//Возвращаем результат
?>

Результат:

Текущий порт: COM9

Ещё пример. Получаем версию u-boot:

<?php
$command = "v";//Команда для вывода версии
$get_version = shell_exec('serial -P COM9 -S '.$command.' -R -D 100');//Отправляем запрос в COM порт
$version = str_replace($command, "", $get_version);//Убираем из результата принятую команду
$version = str_replace("U-Boot#", "", $version);//Убираем из результата приглашение "U-Boot#"
$version = str_replace("U-Boot", "", $version);//Убираем из результата "U-Boot" в начале
echo "Версия U-Boot: ".$version;//Возвращаем результат
?>

Результат:

Версия U-Boot: 2013.04-dirty (Jan 04 2015 - 17:08:05) arm-angstrom-linux-gnueabi-gcc (Linaro GCC 4.7-2013.07) 4.7.4 20130626 (prerelease) GNU ld (GNU Binutils) 2.23.1.20121113

Все аргументы програмы можно получить через -help или -H

<?php
$get_help = shell_exec('serial -H');//Получить справку о програме
$get_help = str_replace("\n", "<br>", $get_help);//Заменяем переносы строк для вывода в браузере
echo $get_help;//Возвращаем результат
?>

Короткое описание аргументов:

Аргумент -P или -port указывает програме, на какой порт обращатся, его можно узнать в дипетчере устройств.
Так же можно узнать нужный COM порт через аргумент -G или -get, програма вернёт имя подключенного COM порта.
Если не указывать аргумент -P или -port, то програма сама попытается подключится к действующему порту.

Аргумент -B или -baud предназначен для выбора скорости порта.
Если этот аргумент не указывать, программа назначит порту по умолчанию скорость = 115200.

Аргумент -S или -send необходим для передачи по серийному порту команды на устройство.
Например: serial -P COM9 -B 115200 -S help
Если команды имеют пробелы, рекомендуется передавать эти команды в кавычках "".
Например: serial -P COM9 -B 115200 -S "mmc info"

Аргумент -R или -read указывает програме, что необходимо вернуть результат, т.е. получить ответ от COM порта.
К этому аргументу прилогается аргумент -D или -delay, который указывает, сколько милисекунд ожидать перед получением ответа.
Задержка нужна при получении больших ответов. Если не указывать аргумент -D или -delay, то ответ будет получен по умолчанию через 300 милисекунд.

Аргумент -H или -help вернёт справку по програме с примерами.

Аргумент -V или -version вернёт информацию о програме.
